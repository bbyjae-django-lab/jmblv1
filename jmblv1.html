<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>JUMBL</title>
  <style>
    /* --------------------------------------
       0) RESET / FOUNDATION
    -------------------------------------- */
    :root{
      color-scheme: light dark;
      --bg: #fafafa;
      --fg: #0f1220;
      --muted: #5b6478;
      --tile-bg: #ffffff;
      --tile-fg: #0f1220;
      --track: #ececec;
      --ok: #22c55e;       /* success green */
      --danger: #ef4444;   /* timeout red */
      --accent-a: #F6C58F; /* gradient start */
      --accent-b: #E8A6D8; /* gradient end */
      --shadow: 0 10px 24px rgba(0,0,0,.08);
      --inset: inset 0 1px 0 rgba(255,255,255,.35);
      --radius: 16px;
      --tile: clamp(68px, 9.5vw, 84px);
      --gap: 16px;
      --row-gap: 18px;
      --tick-ms: 200;
      --timer-h: 14px;
      --btn-h: 48px;
      --btn-radius: 14px;
      --focus: 2px solid #7aa2ff;
      --flash-ms: 850ms;
    }
    :root[data-theme="dark"]{
      --bg:#12151C; --fg:#F7F7FA; --muted:#9aa0af; --tile-bg:#1B2030; --tile-fg:#F7F7FA; --track:#2A2E39;
    }
    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0; font: 16px/1.4 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg); color: var(--fg);
      min-height: 100svh; padding-bottom: max(20px, env(safe-area-inset-bottom));
      display:flex; flex-direction:column; align-items:stretch;
      -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
      touch-action: manipulation;
    }
    .app{ width: min(560px, 100%); margin-inline:auto; padding: 12px 16px 24px; }

    .visually-hidden{ position:absolute !important; left:-9999px !important; width:1px !important; height:1px !important; overflow:hidden !important; }

    /* --------------------------------------
       1) HEADER (three-cell layout)
    -------------------------------------- */
    header{
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:8px; padding: 10px 0 2px;
    }
    .hdr-left{ justify-self:start; }
    .hdr-title{ justify-self:center; font-weight:800; letter-spacing:1.2px; }
    .hdr-right{ justify-self:end; display:flex; align-items:center; gap:8px; }
    .brand{ font-size: clamp(22px, 5.2vw, 28px); }

    .toggle{
      display:inline-grid; place-items:center; height:36px; width:36px; border-radius: 10px; border:1px solid rgba(0,0,0,.08);
      background: var(--tile-bg); color: var(--fg); box-shadow: var(--shadow), var(--inset); cursor:pointer;
    }
    .toggle:focus{ outline: var(--focus); outline-offset: 2px; }

    /* --------------------------------------
       2) STATUS + TIMER
    -------------------------------------- */
    .status{
      margin-top: 6px; display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; font-size: 14px; color: var(--muted);
    }
    .status .level{ justify-self:start; }
    .status .lives{ justify-self:center; display:flex; align-items:center; gap:8px; }
    .status .clock{ justify-self:end; font-variant-numeric: tabular-nums; }

    .pips{ display:inline-flex; gap:6px; }
    .pip{ width:10px; height:10px; border-radius:999px; background: currentColor; opacity: .25; }
    .pip.on{ opacity: 1; }

    .timer{ position:relative; height: var(--timer-h); border-radius: 9999px; background: var(--track); box-shadow: var(--inset); margin: 10px 0 18px; overflow:hidden; }
    .timer .fill{
      position:absolute; top:0; left:0; height:100%;
      /* Drain RIGHT â†’ LEFT by anchoring left and shrinking width */
      width:100%;
      background: linear-gradient(135deg, var(--accent-a) 0%, var(--accent-b) 100%);
      transition: width calc(var(--tick-ms) * 1ms) linear;
    }

    /* --------------------------------------
       3) GRID ROWS (Answer above Bank)
    -------------------------------------- */
    .rows{ display:block; text-align:center; }
    .answer, .bank{
      display:inline-grid; grid-template-columns: repeat(5, var(--tile)); gap: var(--gap);
      width: min-content; margin-inline: auto; align-items: start;
    }
    .answer{ margin-block-end: var(--row-gap); }
    .bank{ margin-block-end: 14px; }

    .slot, .letter{
      width: var(--tile); height: var(--tile); display:grid; place-items:center; border-radius: var(--radius);
      box-shadow: var(--shadow), var(--inset); user-select:none; -webkit-user-select:none;
      font-weight: 800; letter-spacing: .5px; text-transform: uppercase; font-size: clamp(22px, 3.2vw, 28px);
    }
    .slot{ background: var(--tile-bg); color: var(--tile-fg); }
    .slot.locked{ outline: 3px solid rgba(125, 200, 255, .55); }
    .slot.filled{ color: #EE7FB2; }

    .letter{
      background: linear-gradient(135deg, var(--accent-a) 0%, var(--accent-b) 100%);
      color: #2d1e2d; cursor:pointer;
    }
    .letter.used{ opacity:.35; filter:saturate(.6); cursor: default; }
    .letter:focus{ outline: var(--focus); outline-offset: 2px; }

    /* --------------------------------------
       4) CONTROLS
    -------------------------------------- */
    .controls{ display:flex; justify-content:center; align-items:center; gap:12px; margin: 6px 0 12px; }
    .btn{
      height: var(--btn-h); min-width: 120px; padding: 0 16px; border-radius: var(--btn-radius);
      border: 1px solid rgba(0,0,0,.08); background: var(--tile-bg); color: var(--fg);
      box-shadow: var(--shadow), var(--inset); cursor:pointer; font-weight:700; text-transform: lowercase;
    }
    .btn:focus{ outline: var(--focus); outline-offset: 2px; }

    /* --------------------------------------
       5) ANIMATIONS (GPU-friendly)
    -------------------------------------- */
    @keyframes shakeX { 10%{ transform: translateX(-6px);} 30%{ transform: translateX(6px);} 50%{ transform: translateX(-4px);} 70%{ transform: translateX(4px);} 90%{ transform: translateX(-2px);} 100%{ transform: translateX(0);} }
    .shake{ animation: shakeX 220ms ease-in-out; }
    .flash-ok{ box-shadow: 0 0 0 4px color-mix(in oklab, var(--ok), transparent 60%); }
    .flash-danger{ box-shadow: 0 0 0 4px color-mix(in oklab, var(--danger), transparent 60%); }
    .pop{ transform: scale(1.0); }
    .pop.go{ transform: scale(1.2); transition: transform 120ms ease; }

    @media (prefers-reduced-motion: reduce){
      .shake{ animation:none; }
      .pop.go{ transform:none; transition:none; }
      .timer .fill{ transition:none; }
    }

    /* --------------------------------------
       6) MODALS
    -------------------------------------- */
    dialog.modal{ border: none; border-radius: 20px; box-shadow: 0 24px 60px rgba(0,0,0,.22); padding: 20px 20px 18px; background: var(--tile-bg); color: var(--fg); width:min(440px, 92vw); }
    dialog::backdrop{ background: rgba(0,0,0,.35); backdrop-filter: blur(2px); }
    .modal h2{ margin: 0 0 8px; font-weight: 800; letter-spacing: .6px; }
    .modal p{ margin:0 0 14px; color: var(--muted); }
    .modal .row{ display:flex; justify-content:center; gap:10px; margin-top: 6px; }
    .modal .primary{ height:48px; min-width:120px; border-radius: var(--btn-radius); border:0; font-weight:800; cursor:pointer; background: linear-gradient(135deg, var(--accent-a) 0%, var(--accent-b) 100%); color:#2d1e2d; }
    .modal .primary:focus{ outline: var(--focus); outline-offset: 2px; }
    .muted{ color: var(--muted); }

    /* --------------------------------------
       7) ERROR BANNER
    -------------------------------------- */
    .error{ display:none; margin: 10px 0 0; padding: 10px 12px; border-radius: 12px; background: color-mix(in oklab, var(--danger), transparent 85%); color: var(--fg); }
    .error.show{ display:block; }
  </style>
</head>
<body>
  <div class="app" id="app" aria-live="off">
    <header>
      <div class="hdr-left" aria-hidden="true"></div>
      <div class="hdr-title brand">JUMBL</div>
      <div class="hdr-right">
        <button id="themeToggle" class="toggle" type="button" aria-label="Toggle theme" title="Toggle theme">ðŸŒ“</button>
      </div>
    </header>

    <div class="status" aria-label="Status">
      <div class="level" id="levelLbl">Level 1</div>
      <div class="lives" aria-label="Lives">
        <div class="pips" id="pips" aria-hidden="true"><span class="pip on"></span><span class="pip on"></span><span class="pip on"></span></div>
        <span class="visually-hidden" id="livesAnnounce">Lives: 3 of 3</span>
      </div>
      <div class="clock" id="clock">00:25</div>
    </div>

    <div class="timer" role="progressbar" aria-label="Time remaining" aria-valuemin="0" aria-valuemax="25" aria-valuenow="25">
      <div class="fill" id="bar"></div>
    </div>

    <div class="rows">
      <div class="answer" id="answerRow" aria-label="Answer slots">
        <!-- 5 answer slots injected -->
      </div>
      <div class="bank" id="bankRow" aria-label="Letter bank">
        <!-- 5 bank letters injected -->
      </div>
    </div>

    <div class="controls" id="controls">
      <button class="btn" id="shuffleBtn" type="button" aria-label="Shuffle letters">Shuffle</button>
      <button class="btn" id="clearBtn" type="button" aria-label="Clear all">Clear all</button>
    </div>

    <div class="error" id="error">Serve files over HTTP (e.g., <code>python3 -m http.server</code>) to load word lists.</div>

    <div class="visually-hidden" aria-live="polite" id="liveClock">25 seconds remaining</div>
    <div class="visually-hidden" aria-live="polite" id="liveMsg"></div>
  </div>

  <!-- Intro Modal -->
  <dialog class="modal" id="intro">
    <h2>Welcome to <strong>JUMBL</strong></h2>
    <p>Tap letters to form the word. Auto-submit on 5 letters. Valid but wrong: lose 1 life and weâ€™ll lock letters in the right spot. Invalid: shake and clear. You have 3 lives. Timer refills each level.</p>
    <div class="row">
      <button class="primary" id="playBtn" type="button">play</button>
    </div>
    <p class="muted" id="loadNote" style="display:none; margin-top:10px;">Word lists didnâ€™t load. Serve files over HTTP to enable play.</p>
  </dialog>

  <!-- Game Over Modal -->
  <dialog class="modal" id="gameover" aria-labelledby="govTitle">
    <h2 id="govTitle">no more lives</h2>
    <p id="govSub">Run time: 00:00 â€” Levels completed: 0</p>
    <div class="row">
      <button class="primary" id="againBtn" type="button">try again âžœ</button>
    </div>
  </dialog>

  <script>
  (function(){
    'use strict';

    /* -----------------------------
       1) STATE
    ----------------------------- */
    const TICK_MS = 200;        // per spec
    const TIMER_MS = 25000;     // per spec

    let ANSWERS = [];
    let ACCEPTED_SET = new Set();

    const state = {
      answerWord: '',
      locked: Array(5).fill(false),
      current: Array(5).fill(''),
      placedIndex: Array(5).fill(null), // slot -> bank index
      bank: [], // [{ch, used} * 5]
      lives: 3,
      level: 1,
      runStart: 0,
      deadline: 0,
      busy: false,
      tickHandle: null,
      listsReady: false,
      lastAnnouncedSec: 25,
    };

    /* -----------------------------
       2) DOM HOOKS
    ----------------------------- */
    const app = document.getElementById('app');
    const bar = document.getElementById('bar');
    const levelLbl = document.getElementById('levelLbl');
    const pips = document.getElementById('pips');
    const livesAnn = document.getElementById('livesAnnounce');
    const clock = document.getElementById('clock');
    const liveClock = document.getElementById('liveClock');
    const liveMsg = document.getElementById('liveMsg');
    const answerRow = document.getElementById('answerRow');
    const bankRow = document.getElementById('bankRow');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const clearBtn = document.getElementById('clearBtn');
    const errorBox = document.getElementById('error');

    const intro = document.getElementById('intro');
    const playBtn = document.getElementById('playBtn');
    const loadNote = document.getElementById('loadNote');
    const gameover = document.getElementById('gameover');
    const againBtn = document.getElementById('againBtn');
    const themeToggle = document.getElementById('themeToggle');

    /* -----------------------------
       3) UTIL
    ----------------------------- */
    const randInt = (n)=> Math.floor(Math.random() * n);
    function shuffleInPlace(arr){
      for (let i = arr.length - 1; i > 0; i--) {
        const j = randInt(i + 1);
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    function fmtMMSS(ms){
      const total = Math.max(0, Math.floor(ms / 1000));
      const m = Math.floor(total / 60).toString().padStart(2,'0');
      const s = (total % 60).toString().padStart(2,'0');
      return `${m}:${s}`;
    }
    function clamp(v, a, b){ return Math.min(b, Math.max(a, v)); }

    function setTheme(theme){
      if (theme === 'dark' || theme === 'light') {
        document.documentElement.dataset.theme = theme;
        localStorage.setItem('JUMBL_THEME', theme);
      } else {
        document.documentElement.removeAttribute('data-theme');
        localStorage.removeItem('JUMBL_THEME');
      }
    }
    function initTheme(){
      const saved = localStorage.getItem('JUMBL_THEME');
      if (saved) { setTheme(saved); return; }
      // default to system
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      setTheme(prefersDark ? 'dark' : 'light');
    }

    /* -----------------------------
       4) RENDER
    ----------------------------- */
    function renderStatus(){
      levelLbl.textContent = `Level ${state.level}`;
      // lives pips
      pips.innerHTML = '';
      for (let i=0;i<3;i++){
        const span = document.createElement('span');
        span.className = 'pip' + (i < state.lives ? ' on' : '');
        pips.appendChild(span);
      }
      livesAnn.textContent = `Lives: ${state.lives} of 3`;
    }

    function renderTimer(now){
      const remain = Math.max(0, state.deadline - now);
      const pct = TIMER_MS > 0 ? (remain / TIMER_MS) : 0;
      // Drain RIGHT â†’ LEFT: anchored left, width shrinks
      bar.style.width = `${pct * 100}%`;
      const sec = Math.floor(remain / 1000);
      clock.textContent = fmtMMSS(remain);
      const pb = bar.parentElement;
      pb.setAttribute('aria-valuenow', String(sec));
      if (sec !== state.lastAnnouncedSec){
        liveClock.textContent = `${sec} seconds remaining`;
        state.lastAnnouncedSec = sec;
      }
    }

    function renderRows(){
      // Answer row
      answerRow.innerHTML = '';
      for (let i=0;i<5;i++){
        const d = document.createElement('div');
        const filled = !!state.current[i];
        d.className = 'slot' + (filled ? ' filled' : '') + (state.locked[i] ? ' locked' : '');
        d.textContent = state.current[i] || '';
        answerRow.appendChild(d);
      }
      // Bank row
      bankRow.innerHTML = '';
      state.bank.forEach((cell, idx)=>{
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'letter' + (cell.used ? ' used' : '');
        b.textContent = cell.ch;
        b.disabled = cell.used || state.busy;
        b.setAttribute('aria-label', cell.used ? `${cell.ch} used` : `Use letter ${cell.ch}`);
        if (!cell.used) b.addEventListener('click', ()=> onLetterTap(idx));
        bankRow.appendChild(b);
      });
    }

    function flashAnswer(colorClass){
      answerRow.classList.add(colorClass);
      setTimeout(()=> answerRow.classList.remove(colorClass), 620);
    }

    function correctAnimation(){
      flashAnswer('flash-ok');
      // tiny pop
      answerRow.classList.add('pop','go');
      setTimeout(()=>{ answerRow.classList.remove('go'); setTimeout(()=> answerRow.classList.remove('pop'), 120); }, 140);
    }

    function invalidAnimation(){
      answerRow.classList.add('shake');
      setTimeout(()=> answerRow.classList.remove('shake'), 240);
    }

    /* -----------------------------
       5) GAME FLOW
    ----------------------------- */
    function loadWordLists(){
      const opts = { cache: 'no-store' };
      const a = fetch('answers.txt', opts).then(r=> r.ok ? r.text() : Promise.reject());
      const g = fetch('guesses.txt', opts).then(r=> r.ok ? r.text() : Promise.reject());
      return Promise.all([a,g]).then(([A,G])=>{
        const sanitize = (txt)=> txt.split(/\r?\n/).map(s=> s.trim().toUpperCase()).filter(s=> /^[A-Z]{5}$/.test(s));
        ANSWERS = sanitize(A);
        ACCEPTED_SET = new Set(sanitize(G));
        if (ANSWERS.length === 0 || ACCEPTED_SET.size === 0) throw new Error('Empty lists');
        state.listsReady = true;
        errorBox.classList.remove('show');
        loadNote.style.display = 'none';
      }).catch(()=>{
        state.listsReady = false;
        errorBox.classList.add('show');
        loadNote.style.display = 'block';
      });
    }

    function startGame(){
      state.lives = 3; state.level = 1; state.runStart = Date.now(); state.busy = false;
      pickAnswer();
      buildBankFrom(state.answerWord);
      state.locked.fill(false); state.current.fill(''); state.placedIndex.fill(null);
      renderStatus(); renderRows();
      startTimer(true);
    }

    function nextLevel(){
      state.level += 1; state.busy = false;
      pickAnswer();
      buildBankFrom(state.answerWord);
      state.locked.fill(false); state.current.fill(''); state.placedIndex.fill(null);
      renderStatus(); renderRows();
      startTimer(true);
    }

    function pickAnswer(){
      state.answerWord = ANSWERS[randInt(ANSWERS.length)];
    }

    function buildBankFrom(word){
      const arr = word.split("").map(ch => ({ ch, used:false }));
      shuffleInPlace(arr);
      state.bank = arr;
    }

    function refreshShuffle(){
      // Shuffle only unused letters, keep used in place to preserve placedIndex mapping
      const unusedIdx = [];
      const unused = [];
      state.bank.forEach((c,i)=>{ if(!c.used){ unusedIdx.push(i); unused.push(c); } });
      shuffleInPlace(unused);
      unusedIdx.forEach((slot, k)=>{ state.bank[slot] = unused[k]; });
      renderRows();
    }

    function onLetterTap(bankIdx){
      if (state.busy) return;
      const b = state.bank[bankIdx];
      if (!b || b.used) return;
      // find next unlocked slot
      const slot = state.locked.findIndex((L, i)=> !L && !state.current[i]);
      if (slot === -1) return;
      state.current[slot] = b.ch;
      state.placedIndex[slot] = bankIdx;
      state.bank[bankIdx].used = true;
      renderRows();
      autoSubmitIfFull();
    }

    function onClearAll(){
      if (state.busy) return;
      for (let i=0;i<5;i++){
        if (!state.locked[i] && state.current[i]){
          const bi = state.placedIndex[i];
          if (bi !== null) state.bank[bi].used = false;
          state.current[i] = '';
          state.placedIndex[i] = null;
        }
      }
      renderRows();
    }

    function autoSubmitIfFull(){
      if (state.busy) return;
      if (state.current.every(ch => ch)){
        const guess = state.current.join('');
        evaluateGuess(guess);
      }
    }

    function evaluateGuess(guess){
      if (state.busy) return;
      state.busy = true;

      if (guess === state.answerWord){
        correctAnimation();
        setTimeout(()=>{ state.busy = false; nextLevel(); }, 150);
        return;
      }

      if (ACCEPTED_SET.has(guess)){
        // valid but wrong â†’ lose 1 life, lock correct positions, clear rest, same answer persists
        state.lives = Math.max(0, state.lives - 1);
        lockCorrectFrom(guess);
        clearUnlocked();
        renderStatus(); renderRows();
        if (state.lives === 0){
          stopTimer(); gameOver(); return;
        }
        state.busy = false;
        return;
      }

      // invalid â†’ shake + clear; no life lost
      invalidAnimation();
      setTimeout(()=>{ clearUnlocked(); renderRows(); state.busy = false; }, 220);
    }

    function lockCorrectFrom(guess){
      for (let i=0;i<5;i++){
        if (guess[i] === state.answerWord[i]){
          state.locked[i] = true;
        }
      }
    }

    function clearUnlocked(){
      for (let i=0;i<5;i++){
        if (!state.locked[i] && state.current[i]){
          const bi = state.placedIndex[i];
          if (bi !== null) state.bank[bi].used = false;
          state.current[i] = '';
          state.placedIndex[i] = null;
        }
      }
    }

    /* -----------------------------
       6) TIMER
    ----------------------------- */
    function startTimer(fullRefill){
      stopTimer();
      state.deadline = Date.now() + TIMER_MS;
      state.lastAnnouncedSec = 25;
      renderTimer(Date.now());
      state.tickHandle = setInterval(()=>{
        const now = Date.now();
        const remain = state.deadline - now;
        renderTimer(now);
        if (remain <= 0){ onTimeout(); }
      }, TICK_MS);
    }
    function stopTimer(){ if (state.tickHandle){ clearInterval(state.tickHandle); state.tickHandle = null; } }

    function onTimeout(){
      if (state.tickHandle){ clearInterval(state.tickHandle); state.tickHandle = null; }
      if (state.busy) return; // guard
      state.busy = true;
      state.lives = Math.max(0, state.lives - 1);
      renderStatus();
      // Reveal: fill answer row with correct word + red flash
      for (let i=0;i<5;i++){
        state.current[i] = state.answerWord[i];
      }
      renderRows();
      liveMsg.textContent = `Timeâ€™s up â€” the word was ${state.answerWord}`;
      answerRow.classList.add('flash-danger');
      setTimeout(()=>{
        answerRow.classList.remove('flash-danger');
        if (state.lives > 0){
          state.busy = false; nextLevel();
        } else {
          gameOver();
        }
      }, 900); // ~0.7â€“1.0s per spec
    }

    /* -----------------------------
       7) GAME OVER
    ----------------------------- */
    function gameOver(){
      stopTimer();
      const elapsed = Date.now() - state.runStart;
      const levelsCompleted = Math.max(0, state.level - 1);
      document.getElementById('govSub').textContent = `Run time: ${fmtMMSS(elapsed)} â€” Levels completed: ${levelsCompleted}`;
      gameover.showModal();
      againBtn.focus();
      state.busy = false;
    }

    /* -----------------------------
       8) INPUT: BUTTONS + KEYBOARD
    ----------------------------- */
    shuffleBtn.addEventListener('click', ()=>{ if(!state.busy) refreshShuffle(); });
    clearBtn.addEventListener('click', ()=>{ if(!state.busy) onClearAll(); });

    document.addEventListener('keydown', (e)=>{
      if (intro.open || gameover.open) return; // ignore when modal open
      if (state.busy) return;
      const tag = (e.target && e.target.tagName) || '';
      if (tag === 'INPUT' || tag === 'TEXTAREA' || e.isComposing) return;
      const key = e.key;

      if (key === ' '){ e.preventDefault(); refreshShuffle(); return; }
      if (key === 'Backspace' || key === 'Delete'){ e.preventDefault(); onClearAll(); return; }

      const A = key.toUpperCase();
      if (/^[A-Z]$/.test(A)){
        e.preventDefault();
        // place leftmost unused matching bank letter (duplicates handled by index)
        const idx = state.bank.findIndex(cell => !cell.used && cell.ch === A);
        if (idx !== -1){ onLetterTap(idx); }
      }
    });

    /* -----------------------------
       9) THEME TOGGLE
    ----------------------------- */
    initTheme();
    themeToggle.addEventListener('click', ()=>{
      const cur = document.documentElement.dataset.theme;
      setTheme(cur === 'dark' ? 'light' : 'dark');
    });

    /* -----------------------------
       10) MODALS FLOW
    ----------------------------- */
    function openIntro(){ intro.showModal(); playBtn.focus(); }
    playBtn.addEventListener('click', ()=>{ if (!state.listsReady) return; intro.close(); startGame(); });
    againBtn.addEventListener('click', ()=>{ gameover.close(); startGame(); });

    /* -----------------------------
       11) INIT
    ----------------------------- */
    // Build blank rows once
    (function initBlank(){
      state.current = Array(5).fill('');
      state.locked = Array(5).fill(false);
      state.bank = Array.from({length:5}, (_,i)=> ({ch: '', used:true}));
      renderStatus(); renderRows(); renderTimer(Date.now());
    })();

    loadWordLists().finally(openIntro);

  })();
  </script>
</body>
</html>
